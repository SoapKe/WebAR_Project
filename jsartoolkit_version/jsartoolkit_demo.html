<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, user-scalable=no, minimum-scale=1.0, maximum-scale=1.0">
    <title>getUserMeida_demo</title>
</head>
<body>

<video autoplay playsinline></video>

<!--<script src="js/artoolkit.debug.js"></script>-->
<!--<script src="js/artoolkit.api.js"></script>-->

<script src="js/three.min.js"></script>
<script src="js/artoolkit.three.js"></script>
<script src="js/artoolkit.min.js"></script>


<script>
    window.ARThreeOnLoad = function() {
        ARController.getUserMediaThreeScene({
            maxARVideoSize: 320,
            cameraParam: 'Data/camera_para.dat',
            facing: 'environment',
            onSuccess: function(arScene, arController, arCameraParam) {

                arController.setPatternDetectionMode(artoolkit.AR_MATRIX_CODE_DETECTION);

                // Track the barcode marker with id 20.
                // markerRoot is a THREE.Object3D that tracks the marker position.
                //
                var markerRoot = arController.createThreeBarcodeMarker(20);

                // Demo Object to overlay on the marker id20
                var geometry = new THREE.CubeGeometry(100,100,100);
                var material = new THREE.MeshBasicMaterial({color: 0x00ff00});
                var cube = new THREE.Mesh(geometry, material);

                markerRoot.add(cube);

                // Add the marker root to the AR scene.
                //
                arScene.scene.add(markerRoot);

                // Create renderer and deal with mobile orientation.
                //
                var renderer = new THREE.WebGLRenderer({antialias: true});
                var f = Math.min(
                    window.innerWidth / arScene.video.videoWidth,
                    window.innerHeight / arScene.video.videoHeight
                );
                var w = f * arScene.video.videoWidth;
                var h = f * arScene.video.videoHeight;

                if (arController.orientation === 'portrait') {
                    renderer.setSize(h,w);
                    renderer.domElement.style.transformOrigin = '0 0';
                    renderer.domElement.style.transform = 'rotate(-90deg) translateX(-100%)';
                } else {
                    renderer.setSize(w,h);
                }
                document.body.appendChild(renderer.domElement);


                // Call arScene.renderOn on each frame,
                // it does marker detection, updates the Three.js scene and draws a new frame.
                //
                var tick = function() {
                    requestAnimationFrame(tick);
                    arScene.renderOn(renderer);
                };
                tick();

            }}
        );
    }

    if (window.ARController && ARController.getUserMediaThreeScene) {
        ARThreeOnLoad();
    }

</script>
</body>
</html>